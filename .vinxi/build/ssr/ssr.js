import{RouterProvider as Q,isPlainObject as y,useRouter as F,useRouterState as w,warning as N,pick as X,TSR_DEFERRED_PROMISE as Y,isPlainArray as Z,defer as ee,createMemoryHistory as te,createControlledPromise as re,createRootRoute as ne,Outlet as se,createFileRoute as oe,lazyRouteComponent as ae,createRouter as ie}from"@tanstack/react-router";import{jsx as p,Fragment as I,jsxs as O}from"react/jsx-runtime";import*as ce from"react";import{createElement as L}from"react";import{eventHandler as le,toWebRequest as de,getResponseHeaders as ue}from"h3";import _ from"jsesc";import"node:async_hooks";import{Readable as z,PassThrough as pe}from"node:stream";import{isbot as W}from"isbot";import T from"react-dom/server";import{ReadableStream as fe}from"node:stream/web";function B(e){return p(Q,{router:e.router})}function q({tag:e,attrs:t,children:r}){switch(e){case"title":return p("title",{...t,suppressHydrationWarning:!0,children:r});case"meta":return p("meta",{...t,suppressHydrationWarning:!0});case"link":return p("link",{...t,suppressHydrationWarning:!0});case"style":return p("style",{...t,dangerouslySetInnerHTML:{__html:r}});case"script":return t&&t.src?p("script",{...t,suppressHydrationWarning:!0}):typeof r=="string"?p("script",{...t,dangerouslySetInnerHTML:{__html:r},suppressHydrationWarning:!0}):null;default:return null}}function me(e){return e instanceof Headers?new Headers(e):Array.isArray(e)?new Headers(e):typeof e=="object"?new Headers(e):new Headers}function k(...e){return e.reduce((t,r)=>{const s=me(r);for(const[n,o]of s.entries())t.set(n,o);return t},new Headers)}const R={stringify:e=>JSON.stringify(e,function(r,s){const n=this[r],o=E.find(i=>i.stringifyCondition(n));return o?o.stringify(n):s}),parse:e=>JSON.parse(e,function(r,s){const n=this[r];if(y(n)){const o=E.find(i=>i.parseCondition(n));if(o)return o.parse(n)}return s}),encode:e=>{if(Array.isArray(e))return e.map(r=>R.encode(r));if(y(e))return Object.fromEntries(Object.entries(e).map(([r,s])=>[r,R.encode(s)]));const t=E.find(r=>r.stringifyCondition(e));return t?t.stringify(e):e},decode:e=>{if(y(e)){const t=E.find(r=>r.parseCondition(e));if(t)return t.parse(e)}return Array.isArray(e)?e.map(t=>R.decode(t)):y(e)?Object.fromEntries(Object.entries(e).map(([t,r])=>[t,R.decode(r)])):e}},g=(e,t,r,s)=>({key:e,stringifyCondition:t,stringify:n=>({[`$${e}`]:r(n)}),parseCondition:n=>Object.hasOwn(n,`$${e}`),parse:n=>s(n[`$${e}`])}),E=[g("undefined",e=>e===void 0,()=>0,()=>{}),g("date",e=>e instanceof Date,e=>e.toISOString(),e=>new Date(e)),g("error",e=>e instanceof Error,e=>({...e,message:e.message,stack:void 0,cause:e.cause}),e=>Object.assign(new Error(e.message),e)),g("formData",e=>e instanceof FormData,e=>{const t={};return e.forEach((r,s)=>{const n=t[s];n!==void 0?Array.isArray(n)?n.push(r):t[s]=[n,r]:t[s]=r}),t},e=>{const t=new FormData;return Object.entries(e).forEach(([r,s])=>{Array.isArray(s)?s.forEach(n=>t.append(r,n)):t.append(r,s)}),t}),g("bigint",e=>typeof e=="bigint",e=>e.toString(),e=>BigInt(e))],he=()=>{const e=F(),t=w({select:o=>o.matches.map(i=>i.meta).filter(Boolean)}),r=ce.useMemo(()=>{const o=[],i={};let c;return[...t].reverse().forEach(a=>{[...a].reverse().forEach(l=>{if(l)if(l.title)c||(c={tag:"title",children:l.title});else{const d=l.name??l.property;if(d){if(i[d])return;i[d]=!0}o.push({tag:"meta",attrs:{...l}})}})}),c&&o.push(c),o.reverse(),o},[t]),s=w({select:o=>o.matches.map(i=>i.links).filter(Boolean).flat(1).map(i=>({tag:"link",attrs:{...i}})),structuralSharing:!0}),n=w({select:o=>{const i=[];return o.matches.map(c=>e.looseRoutesById[c.routeId]).forEach(c=>{var a,l,d,m;return(m=(d=(l=(a=e.ssr)==null?void 0:a.manifest)==null?void 0:l.routes[c.id])==null?void 0:d.preloads)==null?void 0:m.filter(Boolean).forEach(S=>{i.push({tag:"link",attrs:{rel:"modulepreload",href:S}})})}),i},structuralSharing:!0});return _e([...r,...n,...s],o=>JSON.stringify(o))},Se=()=>{const e=he();return p(I,{children:e.map(t=>L(q,{...t,key:`tsr-meta-${JSON.stringify(t)}`}))})},ye=()=>p(I,{children:Se()});function _e(e,t){const r=new Set;return e.filter(s=>{const n=t(s);return r.has(n)?!1:(r.add(n),!0)})}const ge=()=>{const e=F(),t=w({select:n=>{var o;const i=[],c=(o=e.ssr)==null?void 0:o.manifest;return c?(n.matches.map(a=>e.looseRoutesById[a.routeId]).forEach(a=>{var l,d;return(d=(l=c.routes[a.id])==null?void 0:l.assets)==null?void 0:d.filter(m=>m.tag==="script").forEach(m=>{i.push({tag:"script",attrs:m.attrs,children:m.children})})}),i):(N(!1,"<Scripts /> found no manifest"),[])},structuralSharing:!0}),{scripts:r}=w({select:n=>({scripts:n.matches.map(o=>o.scripts).flat(1).filter(Boolean).map(({children:o,...i})=>({tag:"script",attrs:{...i,suppressHydrationWarning:!0},children:o}))})}),s=[...r,...t];return p(I,{children:s.map((n,o)=>L(q,{...n,key:`tsr-scripts-${n.tag}-${o}`}))})},Re=`const __TSR_SSR__={matches:[],streamedValues:{},initMatch:o=>(__TSR_SSR__.matches.push(o),o.extracted?.forEach(l=>{if(l.type==="stream"){let r;l.value=new ReadableStream({start(e){r={enqueue:t=>{try{e.enqueue(t)}catch{}},close:()=>{try{e.close()}catch{}}}}}),l.value.controller=r}else{let r,e;l.value=new Promise((t,a)=>{e=a,r=t}),l.value.reject=e,l.value.resolve=r}}),!0),resolvePromise:({matchId:o,id:l,promiseState:r})=>{const e=__TSR_SSR__.matches.find(t=>t.id===o);if(e){const t=e.extracted?.[l];if(t&&t.type==="promise"&&t.value&&r.status==="success")return t.value.resolve(r.data),!0}return!1},injectChunk:({matchId:o,id:l,chunk:r})=>{const e=__TSR_SSR__.matches.find(t=>t.id===o);if(e){const t=e.extracted?.[l];if(t&&t.type==="stream"&&t.value?.controller)return t.value.controller.enqueue(new TextEncoder().encode(r.toString())),!0}return!1},closeStream:({matchId:o,id:l})=>{const r=__TSR_SSR__.matches.find(e=>e.id===o);if(r){const e=r.extracted?.[l];if(e&&e.type==="stream"&&e.value?.controller)return e.value.controller.close(),!0}return!1},cleanScripts:()=>{document.querySelectorAll(".tsr-once").forEach(o=>{o.remove()})}};window.__TSR_SSR__=__TSR_SSR__;
`;function we(e,t){e.ssr={manifest:t,serializer:R},e.serverSsr={injectedHtml:[],streamedKeys:new Set,injectHtml:r=>{const s=Promise.resolve().then(r);return e.serverSsr.injectedHtml.push(s),e.emit({type:"onInjectedHtml",promise:s}),s.then(()=>{})},injectScript:(r,s)=>e.serverSsr.injectHtml(async()=>`<script class='tsr-once'>${await r()}; if (typeof __TSR_SSR__ !== 'undefined') __TSR_SSR__.cleanScripts()<\/script>`),streamValue:(r,s)=>{N(!e.serverSsr.streamedKeys.has(r),"Key has already been streamed: "+r),e.serverSsr.streamedKeys.add(r),e.serverSsr.injectScript(()=>`__TSR_SSR__.streamedValues['${r}'] = { value: ${_(e.ssr.serializer.stringify(s),{isScriptContext:!0,wrap:!0,json:!0})}}`)},onMatchSettled:xe},e.serverSsr.injectScript(()=>Re,{logScript:!1})}function ve(e){var t,r;const s={manifest:e.ssr.manifest,dehydratedData:(r=(t=e.options).dehydrate)==null?void 0:r.call(t)};e.serverSsr.injectScript(()=>`__TSR_SSR__.dehydrated = ${_(e.ssr.serializer.stringify(s),{isScriptContext:!0,wrap:!0,json:!0})}`)}function be(e,t){const r=[];return{replaced:A(e,(n,o)=>{if(n instanceof ReadableStream){const[i,c]=n.tee(),a={type:"stream",path:o,id:r.length,matchIndex:t.match.index,stream:c};return r.push(a),i}else if(n instanceof Promise){const i=ee(n),c={type:"promise",path:o,id:r.length,matchIndex:t.match.index,promise:i};r.push(c)}return n}),extracted:r}}function xe(e){const{router:t,match:r}=e;let s,n;if(r.loaderData!==void 0){const a=be(r.loaderData,{match:r});r.loaderData=a.replaced,s=a.extracted,n=s.reduce((l,d)=>C(l,["temp",...d.path],void 0),{temp:a.replaced}).temp}const o=`__TSR_SSR__.initMatch(${_({id:r.id,__beforeLoadContext:t.ssr.serializer.stringify(r.__beforeLoadContext),loaderData:t.ssr.serializer.stringify(n),error:t.ssr.serializer.stringify(r.error),extracted:s?.map(a=>X(a,["type","path"])),updatedAt:r.updatedAt,status:r.status},{isScriptContext:!0,wrap:!0,json:!0})})`;t.serverSsr.injectScript(()=>o),s&&s.forEach(a=>a.type==="promise"?i(a):c(a));function i(a){t.serverSsr.injectScript(async()=>(await a.promise,`__TSR_SSR__.resolvePromise(${_({matchId:r.id,id:a.id,promiseState:a.promise[Y]},{isScriptContext:!0,wrap:!0,json:!0})})`))}function c(a){t.serverSsr.injectHtml(async()=>{try{const l=a.stream.getReader();let d=null;for(;!(d=await l.read()).done;)if(d.value){const m=`__TSR_SSR__.injectChunk(${_({matchId:r.id,id:a.id,chunk:d.value},{isScriptContext:!0,wrap:!0,json:!0})})`;t.serverSsr.injectScript(()=>m)}t.serverSsr.injectScript(()=>`__TSR_SSR__.closeStream(${_({matchId:r.id,id:a.id},{isScriptContext:!0,wrap:!0,json:!0})})`)}catch(l){console.error("stream read error",l)}return""})}}function C(e,t,r){if(t.length===0)return r;const[s,...n]=t;return Array.isArray(e)?e.map((o,i)=>i===Number(s)?C(o,n,r):o):y(e)?{...e,[s]:C(e[s],n,r)}:e}function A(e,t,r=[]){if(Z(e))return e.map((n,o)=>A(n,t,[...r,`${o}`]));if(y(e)){const n={};for(const o in e)n[o]=A(e[o],t,[...r,o]);return n}const s=t(e,r);return s!==e?s:e}function Te({createRouter:e,getRouterManifest:t}){return r=>le(async s=>{const n=de(s),o=new URL(n.url),i=o.href.replace(o.origin,""),c=te({initialEntries:[i]}),a=e();we(a,t?.()),a.update({history:c}),await a.load(),ve(a);const l=Ee({event:s,router:a});return await r({request:n,router:a,responseHeaders:l})})}function Ee(e){e.event.__tsrHeadersSent=!0;let t=k(ue(e.event),{"Content-Type":"text/html; charset=UTF-8"},...e.router.state.matches.map(s=>s.headers));const{redirect:r}=e.router.state;return r&&(t=k(t,r.headers,{Location:r.href})),t}function He(e,t){return U(e,t)}function je(e,t){return z.fromWeb(U(e,z.toWeb(t)))}const Ce=/(<body)/,Ae=/(<\/body>)/,Ie=/(<\/html>)/,Me=/(<head.*?>)/,De=/(<\/[a-zA-Z][\w:.-]*?>)/g,Pe=new TextDecoder;function $e(){let e;const t=new TextEncoder,s={stream:new fe({start(n){e=n}}),write:n=>{e.enqueue(t.encode(n))},end:n=>{n&&e.enqueue(t.encode(n)),e.close(),s.destroyed=!0},destroy:n=>{e.error(n)},destroyed:!1};return s}async function Oe(e,t){var r,s,n;try{const o=e.getReader();let i;for(;!(i=await o.read()).done;)(r=t.onData)==null||r.call(t,i);(s=t.onEnd)==null||s.call(t)}catch(o){(n=t.onError)==null||n.call(t,o)}}function U(e,t){const r=$e();let s=!0,n="",o="",i=!1,c=!1,a="",l="";function d(){const u=n;return n="",u}function m(u){return u instanceof Uint8Array?Pe.decode(u):String(u)}const S=re();let v=0;e.serverSsr.injectedHtml.forEach(u=>{M(u)});const K=e.subscribe("onInjectedHtml",u=>{M(u.promise)});function M(u){v++,u.then(b=>{i?r.write(b):n+=b}).catch(S.reject).finally(()=>{v--,!s&&v===0&&(K(),S.resolve())})}return S.then(()=>{const u=l+d()+o;r.end(u)}).catch(u=>{console.error("Error reading routerStream:",u),r.destroy(u)}),Oe(t,{onData:u=>{const b=m(u.value);let f=a+b;const H=f.match(Ae),D=f.match(Ie);if(i||f.match(Ce)&&(i=!0),!c){const h=f.match(Me);if(h){c=!0;const P=h.index,$=h[0],G=f.slice(P+$.length);r.write(f.slice(0,P)+$+d()),f=G}}if(!i){r.write(f),a="";return}if(H&&D&&H.index<D.index){const h=H.index;o=f.slice(h),r.write(f.slice(0,h)+d()),a="";return}let j,x=0;for(;(j=De.exec(f))!==null;)x=j.index+j[0].length;if(x>0){const h=f.slice(0,x)+d()+l;r.write(h),a=f.slice(x)}else a=f,l+=d()},onEnd:()=>{s=!1,v===0&&S.resolve()},onError:u=>{console.error("Error reading appStream:",u),r.destroy(u)}}),r.stream}const ze=async({request:e,router:t,responseHeaders:r})=>{if(typeof T.renderToReadableStream=="function"){const s=await T.renderToReadableStream(p(B,{router:t}),{signal:e.signal});W(e.headers.get("User-Agent"))&&await s.allReady;const n=He(t,s);return new Response(n,{status:t.state.statusCode,headers:r})}if(typeof T.renderToPipeableStream=="function"){const s=new pe;try{const o=T.renderToPipeableStream(p(B,{router:t}),{...W(e.headers.get("User-Agent"))?{onAllReady(){o.pipe(s)}}:{onShellReady(){o.pipe(s)}},onError:(i,c)=>{console.error("Error in renderToPipeableStream:",i,c)}})}catch(o){console.error("Error in renderToPipeableStream:",o)}const n=je(t,s);return new Response(n,{status:t.state.statusCode,headers:r})}throw new Error("No renderToReadableStream or renderToPipeableStream found in react-dom/server. Ensure you are using a version of react-dom that supports streaming.")},We=()=>({routes:{__root__:{filePath:"__root.tsx",children:["/"],preloads:["/_build/assets/client-DNUANfAl.js","/_build/assets/client-BDQX6FdU.js"]},"/":{filePath:"index.tsx"}}});function Be(e){return globalThis.MANIFEST[e]}function ke(){const e=We(),t=e.routes.__root__=e.routes.__root__||{};t.assets=t.assets||[];const r=Be("client");return t.assets.push({tag:"script",attrs:{src:r.inputs[r.handler]?.output.path,type:"module",suppressHydrationWarning:!0,async:!0}}),e}function Fe(){const e=ke();return{...e,routes:Object.fromEntries(Object.entries(e.routes).map(([t,r])=>{const{preloads:s,assets:n}=r;return[t,{preloads:s,assets:n}]}))}}const Ne="/_build/assets/app-CYe6N5Ey.css",V=ne({head:()=>({meta:[{charSet:"utf-8"},{name:"viewport",content:"width=device-width, initial-scale=1"},{title:"WTDT",description:"What to do today?"},{property:"og:title",content:"WTDT"},{property:"og:description",content:"What to do today?"},{property:"og:type",content:"website"},{property:"og:image",content:"/og-image.webp"},{name:"twitter:card",content:"summary_large_image"},{name:"twitter:title",content:"WTDT"},{name:"twitter:description",content:"What to do today?"},{name:"twitter:image",content:"/og-image.webp"}],links:[{rel:"stylesheet",href:Ne},{rel:"manifest",href:"/site.webmanifest"},{rel:"icon",type:"image/png",sizes:"32x32",href:"/favicon-32x32.png"},{rel:"icon",type:"image/png",sizes:"16x16",href:"/favicon-16x16.png"},{rel:"apple-touch-icon",sizes:"180x180",href:"/apple-touch-icon.png"}]}),component:Le});function Le(){return p(qe,{children:p(se,{})})}function qe({children:e}){return O("html",{children:[p("head",{children:p(ye,{})}),O("body",{children:[e,p(ge,{})]})]})}const Ue=()=>import("./assets/index-ldWUXKM6.js"),J=oe("/")({component:ae(Ue,"component",()=>J.ssr)}),Ve=J.update({id:"/",path:"/",getParentRoute:()=>V}),Je={IndexRoute:Ve},Ke=V._addFileChildren(Je)._addFileTypes();function Ge(){return ie({routeTree:Ke,scrollRestoration:!0})}const at=Te({createRouter:Ge,getRouterManifest:Fe})(ze);export{at as default};
